imports:
  root: __package__.yml
types:
  PublishEvent:
    discriminated: false
    source:
      openapi: assistant-asyncapi.json
    union:
      - type: root.AudioInput
      - type: root.SessionSettings
      - type: root.UserInput
      - type: root.AssistantInput
      - type: root.ToolResponseMessage
      - type: root.ToolErrorMessage
      - type: root.PauseAssistantMessage
      - type: root.ResumeAssistantMessage
  SubscribeEvent:
    discriminated: false
    source:
      openapi: assistant-asyncapi.json
    union:
      - type: root.AssistantEnd
      - type: root.AssistantMessage
      - type: root.AudioOutput
      - type: root.ChatMetadata
      - type: root.WebSocketError
      - type: root.UserInterruption
      - type: root.UserMessage
      - type: root.ToolCallMessage
      - type: root.ToolResponseMessage
      - type: root.ToolErrorMessage
channel:
  auth: false
  examples:
    - messages:
        - body:
            data: data
            type: audio_input
          type: publish
        - body:
            type: assistant_end
          type: subscribe
  messages:
    publish:
      body: PublishEvent
      origin: client
    subscribe:
      body: SubscribeEvent
      origin: server
  path: /v0/evi/chat
  query-parameters:
    access_token:
      default: ''
      docs: >-
        Access token used for authenticating the client. If not provided, an
        `api_key` must be provided to authenticate.


        The access token is generated using both an API key and a Secret key,
        which provides an additional layer of security compared to using just an
        API key.


        For more details, refer to the [Authentication Strategies
        Guide](/docs/introduction/api-key#authentication-strategies).
      type: optional<string>
    api_key:
      default: ''
      docs: >-
        API key used for authenticating the client. If not provided, an
        `access_token` must be provided to authenticate.


        For more details, refer to the [Authentication Strategies
        Guide](/docs/introduction/api-key#authentication-strategies).
      type: optional<string>
    config_id:
      docs: >-
        The unique identifier for an EVI configuration.


        Include this ID in your connection request to equip EVI with the Prompt,
        Language Model, Voice, and Tools associated with the specified
        configuration. If omitted, EVI will apply [default configuration
        settings](/docs/empathic-voice-interface-evi/configuration#default-configuration).


        For help obtaining this ID, see our [Configuration
        Guide](/docs/empathic-voice-interface-evi/configuration).
      type: optional<string>
    config_version:
      docs: >-
        The version number of the EVI configuration specified by the
        `config_id`.


        Configs, as well as Prompts and Tools, are versioned. This versioning
        system supports iterative development, allowing you to progressively
        refine configurations and revert to previous versions if needed.


        Include this parameter to apply a specific version of an EVI
        configuration. If omitted, the latest version will be applied.
      type: optional<integer>
    resumed_chat_group_id:
      docs: >-
        The unique identifier for a Chat Group. Use this field to preserve
        context from a previous Chat session.


        A Chat represents a single session from opening to closing a WebSocket
        connection. In contrast, a Chat Group is a series of resumed Chats that
        collectively represent a single conversation spanning multiple sessions.
        Each Chat includes a Chat Group ID, which is used to preserve the
        context of previous Chat sessions when starting a new one.


        Including the Chat Group ID in the `resumed_chat_group_id` query
        parameter is useful for seamlessly resuming a Chat after unexpected
        network disconnections and for picking up conversations exactly where
        you left off at a later time. This ensures preserved context across
        multiple sessions.


        There are three ways to obtain the Chat Group ID:


        - [Chat
        Metadata](/reference/empathic-voice-interface-evi/chat/chat#receive.Chat%20Metadata.type):
        Upon establishing a WebSocket connection with EVI, the user receives a
        Chat Metadata message. This message contains a `chat_group_id`, which
        can be used to resume conversations within this chat group in future
        sessions.


        - [List Chats
        endpoint](/reference/empathic-voice-interface-evi/chats/list-chats): Use
        the GET `/v0/evi/chats` endpoint to obtain the Chat Group ID of
        individual Chat sessions. This endpoint lists all available Chat
        sessions and their associated Chat Group ID.


        - [List Chat Groups
        endpoint](/reference/empathic-voice-interface-evi/chat-groups/list-chat-groups):
        Use the GET `/v0/evi/chat_groups` endpoint to obtain the Chat Group IDs
        of all Chat Groups associated with an API key. This endpoint returns a
        list of all available chat groups.
      type: optional<string>
    verbose_transcription:
      default: false
      docs: >-
        A flag to enable verbose transcription. Set this query parameter to
        `true` to have unfinalized user transcripts be sent to the client as
        interim UserMessage messages. The
        [interim](/reference/empathic-voice-interface-evi/chat/chat#receive.User%20Message.interim)
        field on a
        [UserMessage](/reference/empathic-voice-interface-evi/chat/chat#receive.User%20Message.type)
        denotes whether the message is "interim" or "final."
      type: optional<boolean>
